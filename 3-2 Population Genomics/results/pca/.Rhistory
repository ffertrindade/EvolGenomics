setwd("G:/OneDrive - PUCRS - BR/dev/EvolGenomics/3-2 Population Genomics/results/pca")
input <- "leopard_17ind.filtered.pruned"
metadata <- "../../data/leopard_17ind_metadata.csv"
## read in data
pca <- read_table2(paste(input,".eigenvec",sep=""), col_names = FALSE)
library(tidyverse)
## read in data
pca <- read_table2(paste(input,".eigenvec",sep=""), col_names = FALSE)
eigenval <- scan((paste(input,".eigenval",sep="")))
popinfo <- read.csv(metadata, sep = ",", header = TRUE)
## sort out the pca data
# remove nuisance column
pca <- pca[,-1]
# set names
names(pca)[1] <- "ind"
names(pca)[2:ncol(pca)] <- paste0("PC", 1:(ncol(pca)-1))
# set populations
pops <- popinfo$Population
pca <- as.tibble(data.frame(pca, pops))
View(pca)
## convert to percentage variance explained
pve <- data.frame(PC = 1:17, pve = eigenval/sum(eigenval)*100)
png(filename=paste("plots/",input, ".PC1-2.png", sep = ""), width=500, height=250)
par(mar=c(5,4,1,1))
b <- ggplot(pca, aes(PC1, PC2, col = pops)) + geom_point(size = 3)
b <- b + scale_colour_manual(values = c("red", "blue", "green", "orange", "gray", "black"))
b <- b + coord_equal() + theme_light()
b + xlab(paste0("PC1 (", signif(pve$pve[1], 3), "%)")) + ylab(paste0("PC2 (", signif(pve$pve[2], 3), "%)"))
dev.off()
